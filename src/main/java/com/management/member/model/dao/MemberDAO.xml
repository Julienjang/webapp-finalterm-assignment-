<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.management.member.model.dao.MemberDAO">

    <!-- MemberDTO type의 resultMap 설정 -->
    <resultMap id="memberResultMap" type="com.management.member.model.dto.MemberDTO">
        <id property="memberCode" column="MEMBER_CODE"/>
        <result property="memberName" column="MEMBER_NAME"/>
        <result property="launchDate" column="LAUNCH_DATE"/>
        <result property="divisionCode" column="DIVISION_CODE"/>
        <result property="detailInfo" column="DETAIL_INFO"/>
        <result property="studentQuantity" column="STUDENT_QUANTITY"/>
        <result property="contact" column="CONTACT"/>
        <result property="teamCode" column="TEAM_CODE"/>
        <result property="activeStatus" column="ACTIVE_STATUS"/>
    </resultMap>

    <!-- 전체 회원 목록을 조회하는 쿼리 -->
    <select id="selectAllMembers" resultMap="memberResultMap">
        SELECT
            MEMBER_CODE,
            MEMBER_NAME,
            LAUNCH_DATE,
            DIVISION_CODE,
            DETAIL_INFO,
            STUDENT_QUANTITY,
            CONTACT,
            TEAM_CODE,
            ACTIVE_STATUS
        FROM
            MEMBER_INFO
    </select>

    <!-- 조건에 따른 회원 목록을 조회하는 쿼리 -->
    <select id="selectMemberByCondition" resultMap="memberResultMap" parameterType="java.lang.String">
        SELECT
        MEMBER_CODE,
        MEMBER_NAME,
        LAUNCH_DATE,
        DIVISION_CODE,
        DETAIL_INFO,
        STUDENT_QUANTITY,
        CONTACT,
        TEAM_CODE,
        ACTIVE_STATUS
        FROM
        MEMBER_INFO
        WHERE
        1 = 1
        <if test="condition != null">
            AND MEMBER_NAME LIKE CONCAT('%', #{condition}, '%')
        </if>
    </select>

    <!-- 회원 정보를 등록하는 쿼리 -->
    <insert id="insertMember" parameterType="com.management.member.model.dto.MemberDTO">
        INSERT INTO MEMBER_INFO (MEMBER_NAME, LAUNCH_DATE, DIVISION_CODE, DETAIL_INFO, STUDENT_QUANTITY, CONTACT, TEAM_CODE, ACTIVE_STATUS)
        VALUES (#{memberName}, #{launchDate}, #{divisionCode}, #{detailInfo}, #{studentQuantity}, #{contact}, #{teamCode}, #{activeStatus})
    </insert>

    <!-- 회원 정보를 수정하는 쿼리 -->
    <update id="updateMemberInfo" parameterType="com.management.member.model.dto.MemberDTO">
        UPDATE MEMBER_INFO
        <set>
            <if test="memberName != null">
                MEMBER_NAME = #{memberName},
            </if>
            <if test="launchDate != null">
                LAUNCH_DATE = #{launchDate},
            </if>
            <if test="divisionCode != null">
                DIVISION_CODE = #{divisionCode},
            </if>
            <if test="detailInfo != null">
                DETAIL_INFO = #{detailInfo},
            </if>
            <if test="studentQuantity != null">
                STUDENT_QUANTITY = #{studentQuantity},
            </if>
            <if test="contact != null">
                CONTACT = #{contact},
            </if>
            <if test="teamCode != null">
                TEAM_CODE = #{teamCode},
            </if>
            <if test="activeStatus != null">
                ACTIVE_STATUS = #{activeStatus}
            </if>
        </set>
        WHERE MEMBER_CODE = #{memberCode}
    </update>

    <!-- 회원 정보를 삭제하는 쿼리 -->
    <delete id="deleteMember" parameterType="java.lang.Integer">
        DELETE FROM MEMBER_INFO
        WHERE MEMBER_CODE = #{memberCode}
    </delete>

</mapper>
